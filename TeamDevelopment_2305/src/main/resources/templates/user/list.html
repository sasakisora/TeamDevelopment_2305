<!DOCTYPE html>
<html>
<head>
  <title>Twitter検索</title>
  <link rel="stylesheet" href="/css/search.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

</head>
<body>
  <div class="container">
    <h1>キーワード検索</h1>

    <div class="search-box">
      <!--<button class="cancel-button">キャンセル</button-->
      <button class="editing-button">マイページ</button>
      <!-- <button class="deleted-button">削除</button> -->
    </div>

    <div class="search-box">
      <input type="text" class="search-input" placeholder="検索キーワードを入力して">
      <button class="search-button">検索</button>
    </div>

    <div class="search-results">
      検索結果
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
    // いいねボタンがクリックされた時の処理
    const likeButtons = document.querySelectorAll(".like-button");
    likeButtons.forEach(button => {
      button.addEventListener("click", function() {
        // ハートの色を切り替える
        this.classList.toggle("liked");
      });
    });

    // 検索ボタンがクリックされた時の処理
    const searchButton = document.querySelector(".search-button");
    searchButton.addEventListener("click", function() {
      // 検索キーワードを取得
      const keyword = document.querySelector(".search-input").value;

      // データベースから検索結果を取得し表示する関数
      function displaySearchResults(results) {
        const searchResults = document.querySelector(".search-results");

        // 検索結果をクリア
        searchResults.innerHTML = "";

        // 検索結果がある場合は表示
        if (results.length > 0) {
          results.forEach(result => {
            const searchResult = document.createElement("div");
            searchResult.classList.add("search-result");

            const content = document.createElement("p");
            content.textContent = result.content;

            const likeButton = document.createElement("button");
            likeButton.classList.add("like-button");
            likeButton.innerHTML = '<i class="fas fa-heart"></i>';

            searchResult.appendChild(content);
            searchResult.appendChild(likeButton);
            searchResults.appendChild(searchResult);
          });
        } else {
          // 検索結果がない場合はメッセージを表示
          const noResultsMessage = document.createElement("p");
          noResultsMessage.textContent = "該当する結果はありません";
          searchResults.appendChild(noResultsMessage);
        }
      }

      // Ajaxリクエストでデータベースから検索結果を取得
      $.ajax({
        url: "/search",
        type: "GET",
        data: { keyword: keyword },
        success: function(response) {
          const results = response.results;
          displaySearchResults(results);
        },
        error: function() {
          console.log("検索エラー");
        }
      });
    });
  </script>
</body>
</html>
